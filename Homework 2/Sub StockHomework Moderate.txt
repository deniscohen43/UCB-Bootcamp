Sub StockHomework()    Dim ws As Worksheet    For Each ws In ActiveWorkbook.Worksheets    ws.Activate        Dim open_price As Double        Dim close_price As Double        Dim yearly As Double        Dim ticker_symbol As String        Dim percent As Double        Dim volume As Double                volume = 0        Dim row As Double        row = 2        Dim column As Integer        column = 1        Dim i As Long                ws.Range("I1").Value = "Ticker"        ws.Range("J1").Value = "Yearly Change"        ws.Range("K1").Value = "Percent Change"        ws.Range("L1").Value = "Total Stock Volume"                last_row = ws.Cells(Rows.Count, 1).End(xlUp).row        open_price = Cells(2, column + 2).Value                For i = 2 To last_row                     If Cells(i + 1, column).Value <> Cells(i, column).Value Then                                ticker_symbol = Cells(i, column).Value                Cells(row, column + 8).Value = ticker_symbol                                close_price = Cells(i, column + 5).Value                                yearly = close_price - open_price                Cells(row, column + 9).Value = yearly                                If (open_price = 0 And close_price = 0) Then                    percent = 0                ElseIf (open_price = 0 And close_price <> 0) Then                    percent = 1                Else                    percent = yearly / open_price                    Cells(row, column + 10).Value = percent                    Cells(row, column + 10).NumberFormat = "0.00%"                End If                                volume = volume + Cells(i, column + 6).Value                Cells(row, column + 11).Value = volume                                row = row + 1                              open_price = Cells(i + 1, column + 2)                               volume = 0                        Else                volume = volume + Cells(i, column + 6).Value                        End If                Next i                        cell_color = ws.Cells(Rows.Count, column + 8).End(xlUp).row                For j = 2 To cell_color            If (Cells(j, column + 9).Value > 0 Or Cells(j, column + 9).Value = 0) Then                Cells(j, column + 9).Interior.ColorIndex = 10            ElseIf Cells(j, column + 9).Value < 0 Then                Cells(j, column + 9).Interior.ColorIndex = 3                        End If                Next j        Next ws        End Sub